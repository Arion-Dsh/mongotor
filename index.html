<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Mongotor by marcelnicolay</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Mongotor</h1>
        <h2>An asynchronous driver and toolkit for accessing MongoDB with Tornado</h2>
        <a href="https://github.com/marcelnicolay/mongotor" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>What is MongoTor ?</h1>

<p>(MONGO + TORnado) is an asynchronous toolkit for accessing mongo with tornado.</p>

<h2>Features</h2>

<ul>
<li>ORM like to map documents and fields</li>
<li>Advanced connection management (replica sets, slave okay)</li>
<li>Automatic reconnection</li>
<li>Connection pooling</li>
<li>Support for running database commands (find, find_one, count, sum, mapreduce etc...)</li>
<li>Signals for pre_save, post_save, pre_remove, post_remove, pre_update and post_update</li>
<li>100% of code coverage by test</li>
</ul><h2>Why not pymongo ?</h2>

<p><a href="http://api.mongodb.org/python/current/">PyMongo</a> is a recommended way to work with MongoDB in python, but isn't asynchronous and not run inside de tornado's ioloop. If you use pymongo you won't take the advantages of tornado.</p>

<h2>Why not asyncmongo ?</h2>

<p><a href="https://github.com/bitly/asyncmongo">AsyncMongo</a> is asynchronous library for accessing mongo with tornado.ioloop, but don't implement replica set, don't have an ORM, I don't like her connection pooling, is deficitary, and i don't trust in your tests. </p>

<p>Besides, this project is not walking very well, or better, very fast. Exist a lot of issues and pull requests that aren't looked.</p>

<p>I am very thankful to asyncmongo, i worked with he in some projects and he's been served as inspiration, but now, I am very excited to write my own library, more flexible, fast, secure and that will walking faster.</p>

<h2>Installing</h2>

<pre><code>pip install mongotor
</code></pre>

<h2>Using ORM</h2>

<pre><code>from mongotor.orm import Collection
from mongotor.orm.field import StringField, ObjectIdField, BooleanField, DateTimeField
from mongotor.database import Database

from datetime import datetime
import tornado.web
from tornado import gen

# A connection to the MongoDB database needs to be established before perform operations
# A connection is stabilished using a Databse object
Database.connect(['localhost:27017','localhost:27018'], 'asyncmongo_test')

class User(Collection):

    __collection__ = "user"

    _id = ObjectIdField()
    name = StringField()
    active = BooleanField()
    created = DateTimeField()

class Handler(tornado.web.RequestHandler):

    @tornado.web.asynchronous
    @gen.engine
    def get(self):
        user = User()
        user.name = "User name"
        user.active = True
        user.created = datetime.now()

        yield gen.Task(user.save)

        # update date
        user.name = "New name"
        yield gen.Task(user.update)

        # find one object
        user_found = yield gen.Task(User.objects.find_one, user._id)

        # find many objects
        new_user = User()
        new_user.name = "new user name"
        new_user.user.active = True
        new_user.created = datetime.now()

        users_actives = yield gen.Task(User.objects.find, {'active': True})

        users_actives[0].active = False
        yield gen.Task(users_actives[0].save)

        # remove object
        yield gen.Task(user_found.remove)
</code></pre>

<h2>Using Client</h2>

<pre><code>from mongotor.database import Database
from bson import ObjectId

class Handler(tornado.web.RequestHandler):

    def initialize(self):
        self.db = Database.connect(['localhost:27017','localhost:27018'], 'asyncmongo_test')

    @tornado.web.asynchronous
    @gen.engine
    def get(self):
        user = {'_id': ObjectId, 'name': 'User Name'}
        yield gen.Task(self.db.user.insert, user)

        yield gen.Task(self.db.user.update, user['_id'], {"$set": {'name': 'New User Name'}})

        user_found = yield gen.Task(self.db.user.find_one, user['_id'])
        assert user_found['name'] == 'New User Name'

        yield gen.Task(self.db.user.remove, user['_id'])
</code></pre>

<h2>Documentation</h2>
<p>For more examples go to full <a href='documentation/'>documentation</a></p>

<h2>Contributing</h2>

<p>Send a pull request (preferred) or patches using <code>git format-patch</code>. Please, write unit and/or functional tests for your new feature.</p>

<h2>Issues</h2>

<p>Please report any issues via <a href="https://github.com/marcelnicolay/mongotor/issues">github issues</a></p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/marcelnicolay/mongotor/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/marcelnicolay/mongotor/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/marcelnicolay/mongotor"></a> is maintained by <a href="https://github.com/marcelnicolay">marcelnicolay</a>.</p>

          <p>This page was generated by <a href="pages.github.com">GitHub Pages</a> using the Architect theme by <a href="http://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>